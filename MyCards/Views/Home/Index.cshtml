@{
    ViewBag.Title = "Home Page";
}


 <div id="map" style="width: 500px; height: 400px;margin-top: 20px;">
 </div>
<input type="hidden"id="mapAddresses" data-value="@ViewBag.restaurantsData" />
<script>
    function initMap() {

        var addresses = $("#mapAddresses").data("value");
        var mapElement = document.getElementById('map');
        var mapOptions = {
           // center: new google.maps.LatLng(44.5403, -78.5463),
            zoom: 8,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        }
        var map = new google.maps.Map(mapElement, mapOptions);
        var geocoder = new google.maps.Geocoder();

        var addressesArray = addresses.split('~');

        for (i = 0; i < addressesArray.length; i++) {
            geocoder.geocode({ 'address': addressesArray[i] }, function (results, status) {
                if (status === google.maps.GeocoderStatus.OK) {
                    var marker = new google.maps.Marker({
                        map: map,
                        position: results[0].geometry.location
                    });
                }
            })
        }

        // Set map center to current location
        var initialLocation;

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function (position) {
            initialLocation = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
            map.setCenter(initialLocation);
                }, function () {
                });
            }
        // Browser doesn't support Geolocation
        else {
            alert("Geolocation service failed.");
        }

    }

</script>
<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAhQ4O1dzFHh07ZDQa3k_ECAbO_LDXQZBA&callback=initMap">
</script>
	
